<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <link rel="stylesheet" href="../../CSS/register.css">
</head>
<body>
    <div class="register-page">
        <header class="topbar">
            <div>
                <h1>Register</h1>
                <p class="subtitle">Managed the selected module here</p>
            </div>
            
        </header>

        <section class="register-panel">
            <h2>Register Patient</h2>
            <form id="registerform"  class="register-form" >
                <div class="row">
                    <input type="text"  id='fullname' placeholder="Full Name" class="input">
                    <input type="tel" id="contactNo" placeholder="Contact No. (11 digits)" class="input" maxlength="11" inputmode="numeric" pattern="[0-9]{11}">
                </div>
                <div class="row-textarea">
                    <textarea id="Address" placeholder="Address" class="textarea"></textarea>
                </div>
                <div class="row">
                    <select class="select" id="vaccineType" style="width: auto; flex: 1;">
                        <option value="" disabled selected hidden>Select Vaccine</option>
                        <option value="Anti-Rabies">Anti-Rabies</option>
                        <option value="Tetanus">Tetanus</option>
                        <option value="Both">Both (Anti-Rabies & Tetanus)</option>
                    </select>
                    <select class="select" id="select" style="width: auto; flex: 1;">
                        <option value="" disabled selected hidden>Assign Wristband</option>
                        <option value="WB001">WB001</option>
                        <option value="WB002">WB002</option>
                        <option value="WB003">WB003</option>
                        <option value="WB004">WB004</option>
                        <option value="WB005">WB005</option>
                        <option value="WB006">WB006</option>
                        <option value="WB007">WB007</option>
                        <option value="WB008">WB008</option>
                        <option value="WB009">WB009</option>
                        <option value="WB010">WB010</option>
                     
                    </select>
                </div>
                <div class="row align-end">
                    <button class="btn-primary" type="submit">Register</button>
                </div>
            </form>
        </section>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-database-compat.js"></script>
    <script src="../../Javascript/firebase.js"></script>
    <script>
        // Restrict contact number input to numbers only and limit to 11 digits
        function setupContactNumberValidation() {
            const contactInput = document.getElementById('contactNo');
            if (contactInput && !contactInput.hasAttribute('data-validated')) {
                contactInput.setAttribute('data-validated', 'true');
                
                // Only allow numeric input
                contactInput.addEventListener('input', function(e) {
                    // Remove any non-numeric characters
                    this.value = this.value.replace(/[^0-9]/g, '');
                });

                // Prevent non-numeric keys from being entered
                contactInput.addEventListener('keypress', function(e) {
                    // Allow: backspace, delete, tab, escape, enter
                    if ([46, 8, 9, 27, 13].indexOf(e.keyCode) !== -1 ||
                        // Allow: Ctrl+A, Ctrl+C, Ctrl+V, Ctrl+X
                        (e.keyCode === 65 && e.ctrlKey === true) ||
                        (e.keyCode === 67 && e.ctrlKey === true) ||
                        (e.keyCode === 86 && e.ctrlKey === true) ||
                        (e.keyCode === 88 && e.ctrlKey === true)) {
                        return;
                    }
                    // Ensure that it is a number and stop the keypress
                    if ((e.shiftKey || (e.keyCode < 48 || e.keyCode > 57)) && (e.keyCode < 96 || e.keyCode > 105)) {
                        e.preventDefault();
                    }
                });

                // Validate on paste
                contactInput.addEventListener('paste', function(e) {
                    e.preventDefault();
                    const paste = (e.clipboardData || window.clipboardData).getData('text');
                    const numbersOnly = paste.replace(/[^0-9]/g, '').substring(0, 11);
                    this.value = numbersOnly;
                });
            }
        }

        // Run on DOMContentLoaded or immediately if already loaded
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', setupContactNumberValidation);
        } else {
            setupContactNumberValidation();
        }

        // Also run after a short delay to handle dynamic loading
        setTimeout(setupContactNumberValidation, 100);
    </script>
</body>
</html>

